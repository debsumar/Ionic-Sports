<!--
  Generated template for the MatchdetailsPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->

<ion-header>
  <ion-navbar>
    <ion-title>Match Details</ion-title>
  </ion-navbar>
</ion-header>

<ion-content>
  <div style="background-color: #f2f5fa">
    <ion-row class="cardrow">
      <ion-col col-12>
        <ion-row>
          <ion-col col-9>
            <p style="margin: 5px 0px; display: flex; align-items: center">
              <span><ion-icon class="smalltext" name="md-calendar"></ion-icon></span>
              <span class="largetext" style="font-weight: 600;">{{matchObj?.start_date}}</span>
            </p>
            <p style="font-weight: 600" class="largetext">
              {{matchObj?.match_title}}
            </p>
            <p class="largetext">
              <span>{{matchObj?.activity_name}}</span>,
              <span>Team</span>
            </p>
            <!-- <p class="largetext">
              <span>Hosted by:</span>
              <span class="largetext">{{matchObj?.club_name}}</span>
            </p> -->
            <p class="largetext">
              <span>Round:</span>
              <span class="largetext">{{matchObj?.formatted_round}}</span>
            </p>
          </ion-col>
          <ion-col col-3 style="margin: auto;">
            <div class="action_btns_div" style="display: inline-block;text-align: center">
                <button ion-button (click)="deleteConfirm()" clear>
                  <ion-icon style="" name="trash"></ion-icon>
                </button>
                <button ion-button (click)="EditLeague()" clear>
                  <ion-icon style="" name="create"></ion-icon>
                </button>
                <button class="" ion-button clear (click)="selectTeamForEmail()">
                    <ion-icon name="mail"></ion-icon>
                </button>
            </div>
          </ion-col>
        </ion-row>
        <ion-row style="margin-right: 25px !important; margin: 0; padding: 0;">
          <ion-col col-8 style="margin: 0; padding: 0;">
            <p style="margin: 5px 0px; display: flex; align-items: center">
              <span><ion-icon class="smalltext" name="pin"></ion-icon></span>
              <span class="smalltext">{{matchObj?.location_name}}</span>
            </p>
          </ion-col>
          <ion-col col-4 style="margin: auto; padding: 0;text-align: right;">
            <p style="margin: 5px 0px; color: #2b92bb; font-weight: 600; cursor: pointer;" (tap)="gotoSummary()">
              Publish Result
            </p>
          </ion-col>
        </ion-row>
      </ion-col>
    </ion-row>
  </div>

  <!-- middle toggle button -->
  <div>
    <div style="padding-bottom: 10px">
      <ion-card style="width: 100%; margin: 0px">
        <ion-card-content style="padding: 0px">
          <ion-row>
            <ion-col col-6>
              <button ion-button class="select-type" (click)="changeType(true)" [class.selected]="activeType">
                {{selectedHomeTeamText}}
                <!-- <ion-icon class="tab-icon hometeam_icon" name="add-circle"></ion-icon> -->
              </button>
            </ion-col>
            <ion-col col-6>
              <button ion-button class=" select-type" (click)="changeType(false)" [class.selected]="!activeType">
                {{selectedAwayTeamText}}
                <!-- <ion-icon class="tab-icon awayteam_icon" name="add-circle"></ion-icon> -->
              </button>
            </ion-col>
          </ion-row>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- lower half screen -->
    <div class="teams_dev">

      <ion-buttons>
        <button ion-button class="select-filter" (click)="getLeagueMatchParticipant(1)"
          [style.opacity]="leagueMatchParticipantInput.leagueTeamPlayerStatusType === 1 ? '1' : '0.48'">
          Playing ({{getPlayingCount()}})
        </button>
        <button ion-button class="select-filter" (click)="getLeagueMatchParticipant(2)"
          [style.opacity]="leagueMatchParticipantInput.leagueTeamPlayerStatusType === 2 ? '1' : '0.48'">
          Bench ({{getBenchCount()}})
        </button>
        <button ion-button class="select-filter" (click)="getLeagueMatchParticipant(0)"
          [style.opacity]="leagueMatchParticipantInput.leagueTeamPlayerStatusType === 0 ? '1' : '0.48'">
          All ({{getAllCount()}})
        </button>
      </ion-buttons>

      <div class="drop-zone" *ngFor="let section of getFilteredSections(); let sectionIndex = index" class="section">
        <h2 class="section-title">{{ section.title }} <span
            style="float: right; margin-right: 8px; color: #32db64;">Confirmed:
            {{getAcceptedCount(section.items)}}</span></h2>
        <div class="itemlist" (dragenter)="onEnterSection(sectionIndex)" (dragleave)="onDragLeaveSection(sectionIndex)"
          (dragover)="$event.preventDefault()" (drop)="onDrop($event, sectionIndex)" [ngStyle]="{
            'max-height': leagueMatchParticipantInput.leagueTeamPlayerStatusType === 0 ? '200px':'none'}">
          <ion-card *ngIf="section.items.length === 0" class="item" draggable="true">
            <ion-card-content class="item-card-content">
              <ion-grid>
                <ion-row>
                  <ion-col col-12 class="margin_auto">
                    <p class="margin_0 para_overflow" style="font-size:1.6rem">No players added</p>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
          <ion-card *ngFor="let item of section.items" class="item" draggable="true" (click)="presentActionSheet(item)"
            (dragstart)="onDragStart($event, item, sectionIndex)" (dragend)="onDragEnd($event)">
            <ion-card-content class="item-card-content">
              <ion-grid>
                <ion-row>
                  <ion-col col-7 class="margin_auto">
                    <p class="playerText margin_0 para_overflow" style="font-size:1.6rem">{{item.user.FirstName}}
                      {{item.user.LastName}}({{item.user.DOB}})</p>
                    <p>{{item.teamrole?.role_name}}</p>
                  </ion-col>
                  <ion-col col-1 class="margin_auto">
                    <img *ngIf="item.user && item.user.Is_Had_Disease" src="assets/images/protection.svg"
                      style="margin-left:5px">
                  </ion-col>
                  <!-- <ion-col col-2 class="margin_auto" style="padding: 7px 0px 0px 0px; line-height: 1;" text-center>
                    {{item.user.DOB}}yrs
                  </ion-col> -->
                  <ion-col col-1 class="margin_auto">
                    <img *ngIf="item.user && item.user.media_consent" src="assets/images/no_camere2.jpeg"
                      class="margin_auto">
                  </ion-col>
                  <ion-col col-3 class="paidBlock margin_auto">
                    <div style="display: flex; align-items: center; justify-content: flex-end;">
                      <p [class]="getInviteStatusDisplay(item.invite_status, item.invite_status_text).cssClass"
                        style="margin: 0; margin-right: 5px;">
                        {{getInviteStatusDisplay(item.invite_status, item.invite_status_text).text}}
                      </p>
                      <ion-icon [name]="getInviteStatusIcon(item.invite_status)"
                        [style.color]="getInviteStatusIcon(item.invite_status) === 'checkmark-circle' ? '#32db64' : getInviteStatusIcon(item.invite_status) === 'close-circle' ? '#f53d3d' : getInviteStatusIcon(item.invite_status) === 'help-circle' ? '#b8860b' : '#f76e04'">
                      </ion-icon>
                    </div>
                    <!-- <div *ngIf=isMatchPaid(item?.Match,item?.paid_amount) style="float: right; margin-top: 0px;">
                      <p class="pending">
                        <span>{{currencyDetails.CurrencySymbol}}{{item.paid_amount}}</span>
                      </p>
                      <p class="pending" style="margin-top:-10px">{{item.amount_pay_status_text}}</p>
                    </div> -->
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
        </div>
      </div>
    </div>


  </div>
</ion-content>

<ion-fab mini right bottom #fab>
  <button style="background-color: #2b92bb !important; color: white !important" ion-fab mini>
    <ion-icon name="add"></ion-icon>
  </button>
  <ion-fab-list side="top">

    <p class="fabEmailText" (tap)="showAvailableTeams(true)" style="margin-right: 46px">Home Team</p>
    <button style="background-color: #2b92bb !important; color: white !important" ion-fab class="fabTop"
      (tap)="showAvailableTeams(true)">
      <ion-icon class="custom-people" name="people"></ion-icon>
      <ion-icon class="custom-add" name="md-add"></ion-icon>
    </button>

    <p class="fabEmailText" (tap)="showAvailableTeams(false)" style="margin-right: 46px">Away Team</p>
    <button style="background-color: #2b92bb !important; color: white !important" ion-fab class="fabTop"
      (tap)="showAvailableTeams(false)">
      <ion-icon class="custom-people" name="people"></ion-icon>
      <ion-icon class="custom-add" name="md-add"></ion-icon>
    </button>

    <!-- <p class="fabEmailText" (tap)="gotoSummary()" style="margin-right: 46px">Update Result</p>
    <button style="background-color: #2b92bb !important; color: white !important" ion-fab class="fabTop"
      (tap)="gotoSummary()">
      <ion-icon name="people"></ion-icon>
    </button> -->

  </ion-fab-list>
</ion-fab>