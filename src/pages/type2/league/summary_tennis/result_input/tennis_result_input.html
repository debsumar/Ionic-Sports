
<ion-header>
  <ion-navbar>
    <ion-title>üèÜ Match Result</ion-title>
    <ion-buttons end style="color:#fff">
      <button ion-button icon-only (click)="cancel()">
        <ion-icon name="close"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content class="result-content">
  <div class="header-section">
    <div class="match-info">
      <ion-icon name="trophy"></ion-icon>
      <h3>{{homeTeamObj && homeTeamObj.parentclubteam && homeTeamObj.parentclubteam.teamName}} vs {{awayTeamObj && awayTeamObj.parentclubteam && awayTeamObj.parentclubteam.teamName}}</h3>
    </div>
    <p class="subtitle">Enter match result details</p>
  </div>

  <div class="result-sections">
    <!-- Match Winner Section -->
    <div class="result-card">
      <div class="card-header">
        <ion-icon name="medal"></ion-icon>
        <span>Match Winner</span>
      </div>
      <div class="winner-options">
        <div class="team-option" [class.selected]="selectedWinner === (homeTeamObj && homeTeamObj.parentclubteam && homeTeamObj.parentclubteam.id)" 
             [class.disabled]="!isEditable"
             (click)="isEditable && (selectedWinner = homeTeamObj && homeTeamObj.parentclubteam && homeTeamObj.parentclubteam.id); $event.stopPropagation()">
          <ion-icon name="checkmark-circle" *ngIf="selectedWinner === (homeTeamObj && homeTeamObj.parentclubteam && homeTeamObj.parentclubteam.id)"></ion-icon>
          <span>{{homeTeamObj && homeTeamObj.parentclubteam && homeTeamObj.parentclubteam.teamName}}</span>
        </div>
        <div class="team-option" [class.selected]="selectedWinner === (awayTeamObj && awayTeamObj.parentclubteam && awayTeamObj.parentclubteam.id)" 
             [class.disabled]="!isEditable"
             (click)="isEditable && (selectedWinner = awayTeamObj && awayTeamObj.parentclubteam && awayTeamObj.parentclubteam.id); $event.stopPropagation()">
          <ion-icon name="checkmark-circle" *ngIf="selectedWinner === (awayTeamObj && awayTeamObj.parentclubteam && awayTeamObj.parentclubteam.id)"></ion-icon>
          <span>{{awayTeamObj && awayTeamObj.parentclubteam && awayTeamObj.parentclubteam.teamName}}</span>
        </div>
      </div>
    </div>

    <!-- Match Status Section -->
    <div class="result-card">
      <div class="card-header">
        <ion-icon name="flag" color="primary"></ion-icon>
        <span>Match Status</span>
      </div>
      <!-- <div class="dropdown-container">
        <ion-select [(ngModel)]="selectedResultStatus" 
                    [disabled]="!isEditable"
                    (ionChange)="onStatusClick($event)"
                    interface="popover"
                    placeholder="Select status">
          <ion-option *ngFor="let status of resultStatusList" [value]="status">
            {{status.status}}
          </ion-option>
        </ion-select>
      </div> -->
      <div class="custom-dropdown">
        <div class="dropdown-trigger" 
             [class.disabled]="!isEditable"
             (click)="isEditable && toggleStatusDropdown()">
          <span class="selected-text">{{selectedResultStatus?.status || 'Select status'}}</span>
          <ion-icon name="chevron-down" [class.rotated]="showStatusDropdown"></ion-icon>
        </div>
        <div class="dropdown-options" *ngIf="showStatusDropdown">
          <div *ngFor="let status of resultStatusList" 
               class="dropdown-option" 
               [class.selected]="selectedResultStatus?.id === status.id"
               (click)="selectStatus(status)">
            <span>{{status.status}}</span>
            <ion-icon name="checkmark" *ngIf="selectedResultStatus?.id === status.id"></ion-icon>
          </div>
        </div>
      </div>
    </div>

    <!-- Sets Won Section -->
    <div class="result-card">
      <div class="card-header">
        <ion-icon name="stats" color="primary"></ion-icon>
        <span>Sets Won</span>
      </div>
      <div class="score-inputs">
        <div class="team-input">
          <label>{{homeTeamObj && homeTeamObj.parentclubteam && homeTeamObj.parentclubteam.teamName}}</label>
          <ion-input type="number" [(ngModel)]="homeSetsWon" min="0" class="score-field" [disabled]="!isEditable"></ion-input>
        </div>
        <div class="vs-separator">vs</div>
        <div class="team-input">
          <label>{{awayTeamObj && awayTeamObj.parentclubteam && awayTeamObj.parentclubteam.teamName}}</label>
          <ion-input type="number" [(ngModel)]="awaySetsWon" min="0" class="score-field" [disabled]="!isEditable"></ion-input>
        </div>
      </div>
    </div>

    <!-- Games Won Section -->
    <div class="result-card">
      <div class="card-header">
        <ion-icon name="analytics" ></ion-icon>
        <span>Games Won</span>
      </div>
      <div class="score-inputs">
        <div class="team-input">
          <label>{{homeTeamObj && homeTeamObj.parentclubteam && homeTeamObj.parentclubteam.teamName}}</label>
          <ion-input type="number" [(ngModel)]="homeGamesWon" min="0" class="score-field" [disabled]="!isEditable"></ion-input>
        </div>
        <div class="vs-separator">vs</div>
        <div class="team-input">
          <label>{{awayTeamObj && awayTeamObj.parentclubteam && awayTeamObj.parentclubteam.teamName}}</label>
          <ion-input type="number" [(ngModel)]="awayGamesWon" min="0" class="score-field" [disabled]="!isEditable"></ion-input>
        </div>
      </div>
    </div>
  </div>
</ion-content>

<ion-footer class="custom-footer">
  <div class="footer-buttons">
    <button ion-button large outline (click)="cancel()">
      <ion-icon name="close"></ion-icon>
      Cancel
    </button>
    <button ion-button large class="timekare-primary-btn" (click)="saveResult()" [disabled]="!isEditable">
      <ion-icon name="checkmark"></ion-icon>
      Save Result
    </button>
  </div>
</ion-footer>